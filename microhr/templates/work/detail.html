{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load humanize %}

{% block main %}
<h1>{{ work.title }}</h1>
<table class="table">
    <tr>
        <td>会社名</td>
        <td>{{ work.company.name }}</td>
    </tr>
    <tr>
        <td>給与</td>
        <td>{{ work.salary_min | intcomma }}万円 ~ {{ work.salary_max | intcomma }}万円</td>
    </tr>
    <tr>
        <td></td>
        <td>
            {{ work.text | linebreaksbr}}
        </td>
    </tr>
    <tr>
        <td>求人登録日</td>
        <td>{{ work.created_at | date:"Y年n月j日 H:i:s"}}</td>
    </tr>
    <tr>
        <td>最終更新日</td>
        <td>{{work.updated_at | date:"Y年n月j日 H:i:s"}}</td>
    </tr>
</table>

<div>
    {% if user.is_authenticated and user.is_company and user == work.company %}
    <a class="btn btn-primary" href="{% url 'work_edit' work.id %}">編集する</a>
    <form method="post" action="{% url 'work_delete' work.id %}" style="display:inline;">
        {% csrf_token %}
        <button type="submit" name="delete_button" class="btn btn-primary" id="btn_del">削除する</button>
    </form>
    {% elif not user.is_company %}
    <form method="post" action="{%url 'work_apply' work.id %}" style="display:inline;">
    {% csrf_token %}
        <button type="submit" name="apply_button" class="btn btn-primary" id="btn_apply">応募する</a>
    </form>        
    {% endif %}
    

<script>
    $(function () {

        $("#btn_apply").click(function(){
            if(!confirm("応募しますか？")){
                //cancelなら応募しない
                return false;                
            }else{
                alert('応募完了後、応募一覧にリダイレクトします')         
            }
        });
  
        $("#btn_del").click(function(){
            if(!confirm("削除しますか？")){
                //cancelなら削除しない
                return false;
            }else{
                alert('削除完了後、HOMEにリダイレクトします')
            }
        });
    });
</script>
{% endblock %}